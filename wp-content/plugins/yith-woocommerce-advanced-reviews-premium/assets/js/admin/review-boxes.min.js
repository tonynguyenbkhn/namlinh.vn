!function(s,c){var d=!1,n=[];function _(i=!0){s.ajax({url:window.location.href,success:function(e){""!==e&&(e=s("<div></div>").html(e).find(".yith-ywar-review-boxes__list"),s(".yith-ywar-review-boxes__list").html(e.html()),i)&&(s(document.body).trigger("wc-enhanced-select-init"),s(document.body).trigger("yith-framework-enhanced-select-init"),s(document.body).trigger("yith_fields_init"),s(document.body).trigger("yith-add-box-button-toggle"))}})}s(document).on("change",".yith-ywar-review-boxes__box__toggle-active .on_off",function(){window.onbeforeunload=null;var e=s(this),i=e.closest(".yith-ywar-review-boxes__box__toggle-active"),e={box_id:e.closest(".yith-ywar-review-boxes__box").data("box-id"),request:"switch_box_activation",enabled:e.is(":checked")?"yes":"no"};c.adminAjax(e,{block:i})}).on("click",".yith-ywar-review-boxes__box__delete-box",function(e){e.preventDefault();var i=s(".yith-ywar-review-boxes__list"),t=s(this).closest(".yith-ywar-review-boxes__box").data("box-id");yith.ui.confirm({title:ywar_admin.modals.delete_review_box.title,message:ywar_admin.modals.delete_review_box.message,confirmButtonType:"delete",confirmButton:ywar_admin.modals.delete_review_box.button,onConfirm:function(){c.adminAjax({box_id:t,request:"delete_box"},{block:i}).done(function(e){e.success&&_(!1)})}})}).on("click",".yith-ywar-review-boxes__box__toggle-editing",function(e){e.preventDefault();var e=s(this).closest(".yith-ywar-review-boxes__box"),i=e.find(".yith-ywar-review-boxes__box__options");e.is(".yith-ywar-review-boxes__box--open")?(e.removeClass("yith-ywar-review-boxes__box--open"),i.slideUp()):(e.addClass("yith-ywar-review-boxes__box--open"),i.slideDown()),n=[]}).on("click",".yith-ywar-review-boxes__box__save",function(){var i=s(this),e=i.closest(".yith-ywar-review-boxes__box"),t=e.data("box-id"),e=e.find("form"),o=i.find(".yith-ywar-review-boxes__box__save__text"),a=i.data("save-message"),n=i.data("saved-message"),r=function(e){e?(i.addClass("is-saved"),o.html(n)):(i.removeClass("is-saved"),o.html(a))},t={box_id:t,request:"update_box_options",data:function(e){var i,t={};for(i of e){var o=new RegExp("(\\[.*?\\])","gmi"),a=i.name.match(o),o=a?i.name.replace(o,""):i.name,n=i.value;a?((a=t[o]||[]).push(n),t[o]=a):t[o]=n}return t}(e.serializeArray())};r(!1),d&&clearTimeout(d),c.adminAjax(t,{block:i}).done(function(e){r(!0),d=setTimeout(function(){r(!1)},1e3),e.success&&_()})}).on("click",".yith-ywar-add-box",function(){var e=s(".yith-ywar-review-boxes__list");c.adminAjax({request:"new_box_options"},{block:e}).done(function(e){e.success&&_()})}).on("click",".yith-ywar-new-criteria",function(e){e.preventDefault();var o=s(this).closest(".yith-ywar-review-boxes__box"),a=o.attr("id");yith.ui.confirm({title:ywar_admin.modals.add_criteria.title,message:ywar_admin.modals.add_criteria.content,confirmButton:ywar_admin.modals.add_criteria.button,closeAfterConfirm:!1,width:450,classes:{wrap:"yith-ywar-criteria-popup"},onConfirm:function(){var i=s(".yith-plugin-fw__panel__section__content"),e={name:i.find("#criterion_name").val(),icon:i.find("#criterion_icon").val(),request:"add_criteria"};c.adminAjax(e,{block:o.find(".multi-criteria")}).done(function(e){e.success?(s(".yith-plugin-fw__confirm__button--cancel").trigger("click"),n.push(e.data.id),s.ajax({url:window.location.href,success:function(e){var t;""!==e&&(e=s("<div></div>").html(e).find("#"+a).find(".multi-criteria"),o.find(".multi-criteria").html(e.html()),e=""===(e=(t=o.find(".multi-criteria").find("select")).data("value"))?n.join(","):e+","+n.join(","),t.attr("data-value",e),s.each(n,function(e,i){t.find('option[value="'+i+'"]').attr("selected","selected")}),s(document.body).trigger("wc-enhanced-select-init"),s(document.body).trigger("yith-framework-enhanced-select-init"))}})):i.append(e.data)})}})})}(jQuery,window.ywar);