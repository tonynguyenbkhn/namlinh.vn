(()=>{"use strict";var e={n:a=>{var t=a&&a.__esModule?()=>a.default:()=>a;return e.d(t,{a:t}),t},d:(a,t)=>{for(var r in t)e.o(t,r)&&!e.o(a,r)&&Object.defineProperty(a,r,{enumerable:!0,get:t[r]})},o:(e,a)=>Object.prototype.hasOwnProperty.call(e,a)};const a=window.wc.productEditor,t=window.React,r=window.wp.element,o=window.wc.blockTemplates,n=window.wp.coreData,l=window.wp.apiFetch;var c=e.n(l);const m=window.wp.components,i=window.wc.navigation,s=window.wp.i18n,d=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"extension/woocommerce-warranty","version":"0.1.0","title":"Woocommerce Warranty","category":"widgets","description":"Product warranty fields.","attributes":{},"supports":{"html":false,"inserter":false},"textdomain":"woocommerce-warranty","editorScript":"file:./index.js","editorStyle":"file:./index.css","usesContext":["postType"]}'),{name:w,...y}=d,u={edit:function({attributes:e,context:l}){const d=(0,o.useWooBlockProps)(e),w=l.postType,[y]=(0,a.__experimentalUseProductEntityProp)("type",{postType:w}),u="variable"===y,_="product_variation"===w,p=(0,n.useEntityId)("postType","product"),[v]=(0,n.useEntityProp)("postType",w,"parent_id"),[b]=(0,n.useEntityProp)("postType","product","meta_data",v),h=(0,r.useMemo)((()=>({type:"",length:"",value:"",duration:"days",no_warranty_option:"",addons:[]})),[]),E=(0,r.useRef)(null),[g,f]=(0,r.useState)(null),[C,W]=(0,r.useState)(h),[k,x]=(0,a.__experimentalUseProductEntityProp)("meta_data._warranty",{postType:w}),[P,T]=(0,a.__experimentalUseProductEntityProp)("meta_data._warranty_label",{postType:w}),[S,D]=(0,a.__experimentalUseProductEntityProp)("meta_data._warranty_control",{postType:w,fallbackValue:"parent"}),O=(0,r.useMemo)((()=>_&&"variations"===g?.value),[_,g]),M=(0,r.useMemo)((()=>!u&&!_||!(!u||"parent"!==S)||O),[u,_,S,O]);(0,r.useEffect)((()=>{_&&b&&f(b.find((e=>"_warranty_control"===e.key)))}),[_,b]),(0,r.useEffect)((()=>{W(k||h)}),[h,k]),(0,r.useEffect)((()=>{const e=null!=v?v:p;c()({path:"/wc/v3/default_warranty/"+e}).then((e=>{E.current=e})).catch((()=>E.current=h))}),[h,v,p]);const B=(0,r.useCallback)((e=>{x({...C,...e})}),[x,C]);return(0,t.createElement)("div",{...d},u&&(0,t.createElement)(m.SelectControl,{label:(0,s.__)("Warranty Control","woocommerce-warranty"),value:S||"parent",options:[{label:(0,s.__)("Define warranty for all variations","woocommerce-warranty"),value:"parent"},{label:(0,s.__)("Define warranty per variation","woocommerce-warranty"),value:"variations"}],onChange:e=>D(e)}),_&&!O&&(0,t.createElement)("div",{className:"woocommerce-product-notice info"},(0,t.createElement)("p",{className:"woocommerce-product-notice__content"},(0,s.__)('Warranty settings are managed at the parent product level. Because the "Warranty Settings Control" is set to "Define warranty for all variations", individual variation warranty options cannot be modified.',"woocommerce-warranty"),"Â ",(0,t.createElement)("a",{href:(0,i.getNewPath)({tab:"warranty-group"},`/product/${v}`)},(0,s.__)("Modify parent product warranty settings.","woocommerce-warranty")))),M&&(0,t.createElement)("div",null,(0,t.createElement)(m.CheckboxControl,{label:(0,s.__)("Default Product Warranty","woocommerce-warranty"),checked:!C.type,onChange:e=>{x(e?null:E.current)}}),(0,t.createElement)("hr",null),C.type&&(0,t.createElement)("div",null,(0,t.createElement)(m.SelectControl,{label:(0,s.__)("Product Warranty","woocommerce-warranty"),value:C.type,options:[{label:(0,s.__)("Select Warranty Type","woocommerce-warranty"),value:""},{label:(0,s.__)("No Warranty","woocommerce-warranty"),value:"no_warranty"},{label:(0,s.__)("Warranty Included","woocommerce-warranty"),value:"included_warranty"},{label:(0,s.__)("Warranty as Add-On","woocommerce-warranty"),value:"addon_warranty"}],onChange:e=>B({type:e})}),"no_warranty"!==C.type&&(0,t.createElement)(m.TextControl,{label:(0,s.__)("Warranty Label","woocommerce-warranty"),value:P||"",onChange:e=>T(e)}),"included_warranty"===C.type&&(0,t.createElement)("div",null,(0,t.createElement)(m.SelectControl,{label:(0,s.__)("Warranty Length","woocommerce-warranty"),value:C.length,options:[{label:(0,s.__)("Select Warranty Length","woocommerce-warranty"),value:""},{label:(0,s.__)("Lifetime","woocommerce-warranty"),value:"lifetime"},{label:(0,s.__)("Limited","woocommerce-warranty"),value:"limited"}],onChange:e=>B({length:e})}),"limited"===C.length&&(0,t.createElement)("div",null,(0,t.createElement)(m.TextControl,{label:(0,s.__)("Warranty Duration Value","woocommerce-warranty"),type:"number",value:C.value,onChange:e=>B({value:e})}),(0,t.createElement)(m.SelectControl,{label:(0,s.__)("Warranty Duration","woocommerce-warranty"),value:C.duration,options:[{label:(0,s.__)("Days","woocommerce-warranty"),value:"days"},{label:(0,s.__)("Weeks","woocommerce-warranty"),value:"weeks"},{label:(0,s.__)("Months","woocommerce-warranty"),value:"months"},{label:(0,s.__)("Years","woocommerce-warranty"),value:"years"}],onChange:e=>B({duration:e||"days"})}))),(0,t.createElement)("hr",null),"addon_warranty"===C.type&&(0,t.createElement)("div",null,(0,t.createElement)(m.CheckboxControl,{label:(0,s.__)('"No Warranty" Option',"woocommerce-warranty"),checked:"yes"===C.no_warranty_option,onChange:e=>B({no_warranty_option:e?"yes":"no"})}),C.addons.map(((e,a)=>(0,t.createElement)("div",{key:a,style:{border:"1px solid #ccc",padding:"10px",marginBottom:"10px"}},(0,t.createElement)(m.TextControl,{label:(0,s.__)("Amount","woocommerce-warranty"),type:"number",value:void 0!==e.amount?e.amount.toString():"",onChange:e=>{const t=parseFloat(e)||0,r=C.addons.map(((e,r)=>r===a?{...e,amount:t}:e));B({addons:r})}}),(0,t.createElement)(m.TextControl,{label:(0,s.__)("Value","woocommerce-warranty"),value:e.value,onChange:e=>{const t=C.addons.map(((t,r)=>r===a?{...t,value:e}:t));B({addons:t})}}),(0,t.createElement)(m.SelectControl,{label:(0,s.__)("Duration","woocommerce-warranty"),value:e.duration,options:[{label:(0,s.__)("Days","woocommerce-warranty"),value:"days"},{label:(0,s.__)("Weeks","woocommerce-warranty"),value:"weeks"},{label:(0,s.__)("Months","woocommerce-warranty"),value:"months"},{label:(0,s.__)("Years","woocommerce-warranty"),value:"years"}],onChange:e=>{const t=C.addons.map(((t,r)=>r===a?{...t,duration:e||"days"}:t));B({addons:t})}}),(0,t.createElement)(m.Button,{isDestructive:!0,onClick:()=>{const e=C.addons.filter(((e,t)=>t!==a));B({addons:e})}},(0,s.__)("Remove Add-On","woocommerce-warranty"))))),(0,t.createElement)(m.Button,{variant:"secondary",onClick:()=>{const e=[...C.addons,{amount:0,value:"",duration:"days"}];B({addons:e})}},(0,s.__)("Add Add-On","woocommerce-warranty"))))))}};(0,a.registerProductEditorBlockType)({name:w,metadata:y,settings:u})})();