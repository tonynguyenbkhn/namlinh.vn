jQuery(document).ready((function(e){"use strict";var t,i,a,s;e(".yith-wrvp-shortcode-tab").each((function(){var t=e(this).find(".form-table input, .form-table select"),i=e(this).find(".shortcode-preview");void 0!==e.fn.select2&&t.filter("select").select2(),t.each((function(){e(this).on("change",(function(){if("radio"!=this.type||e(this).is(":checked")){var t,a="checkbox"!=this.type||e(this).is(":checked")?e(this).val():"no",s=this.name.replace("[]",""),n=i.text(),c=new RegExp(s+'="([^"]*)"',"g");if(n=n.replace(c,""),a)n=n.replace("]",""),"object"==typeof a&&(a=a.join(",")),t=s+'="'+(a=a.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"))+'"',i.text(n+" "+t+"]");else i.text(n)}})).change()}))})),e(document).on("keyup","#yith-wrvp-test-mail",(function(){t&&t.abort(),e(this).removeClass("error valid loading")})),e(document).on("click",".ywrvp-send-test-email",(function(i){i.preventDefault();e(this).closest(".yith-wrvp-test-email-wrap");var a,s=e("#yith-wrvp-test-mail"),n=s.val().toLowerCase();if(t&&t.abort(),!n||!function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}(n))return s.addClass("error"),!1;(a=e("#plugin-fw-wc").serializeArray()).push({name:"action",value:ywrvp.testEmailAction},{name:"security",value:ywrvp.testEmailNonce}),t=e.ajax({url:ajaxurl,method:"POST",data:a,dataType:"json",beforeSend:function(){s.addClass("loading")},success:function(e){s.removeClass("loading"),e.success?s.removeClass("error").addClass("valid"):s.removeClass("valid").addClass("error")},complete:function(){t=!1}})})),e("#yith_wrvp_panel_email").find("[data-deps]").each((function(){var t=e(this),i=t.closest("tr"),a=t.attr("data-deps").split(","),s=t.attr("data-deps_value").split(","),n=[];e.each(a,(function(t,a){e('[name="'+a+'"]').on("change",(function(){var a=this.value,c="";("radio"!=this.type||e(this).is(":checked"))&&("checkbox"==this.type&&(a=e(this).is(":checked")?"yes":"no"),c=(c=s[t]+"").split("|"),n[t]=-1!==e.inArray(a,c),-1===e.inArray(!1,n)?i.fadeIn():i.fadeOut())})).change()}))})),e(document).find("input.yith_wrvp_coupon_validate").on("keyup",(function(){var t=e(this),a=t.val();i&&i.abort(),a?(t.addClass("loading"),i=e.ajax({url:ajaxurl,method:"POST",data:{action:ywrvp.validateCouponAction,security:ywrvp.validateCouponNonce,code:a},dataType:"json",success:function(e){t.removeClass("loading"),e.valid?t.removeClass("error").addClass("valid"):t.removeClass("valid").addClass("error")},complete:function(){i=!1}})):t.removeClass("error valid loading")})).keyup(),a=function(t){var i=[];return e.each(t,(function(t,a){(a=e.trim(a))&&-1===e.inArray(a,i)&&i.push(a)})),i},(s={clean:function(e){return e=e.replace(/\s*,\s*/g,",").replace(/,+/g,",").replace(/[,\s]+$/,"").replace(/^[,\s]+/,"")},parseTags:function(t){var i=t.id.split("-check-num-")[1],a=e(t).closest(".ywrvp-checklist-div"),s=a.find(".ywrvp-values"),n=s.val().split(","),c=[];return delete n[i],e.each(n,(function(t,i){(i=e.trim(i))&&c.push(i)})),s.val(this.clean(c.join(","))),this.quickClicks(a),!1},quickClicks:function(t){var i,a=e(".ywrvp-values",t),n=e(".ywrvp-value-list ul",t),c=e(t).attr("id");a.length&&(i=a.val().split(","),n.empty(),e.each(i,(function(t,i){var a,r;(i=e.trim(i))&&(a=e('<li class="select2-selection__choice" />'),(r=e('<span id="'+c+"-check-num-"+t+'" class="select2-selection__choice__remove" tabindex="0"></span>')).on("click keypress",(function(t){"click"!==t.type&&13!==t.keyCode||(13===t.keyCode&&e(this).closest(".ywrvp-checklist-div").find("input.ywrvp-insert").focus(),s.parseTags(this))})),a.prepend(i).prepend(r),n.append(a))})))},flushTags:function(t,i,s){var n,c,r,l=e(".ywrvp-values",t),o=e("input.ywrvp-insert",t);return void 0===(r=(i=i||!1)?e(i).text():o.val())||(c=(n=l.val())?n+","+r:r,c=this.clean(c),c=a(c.split(",")).join(","),l.val(c),this.quickClicks(t),i||o.val(""),void 0===s&&o.focus()),!1},init:function(){var t=e(".ywrvp-checklist-ajax");e(".ywrvp-checklist-div").each((function(){s.quickClicks(this)})),e("input.ywrvp-insert",t).keyup((function(t){if(13===t.which)return s.flushTags(e(this).closest(".ywrvp-checklist-div")),!1})).keypress((function(e){if(13===e.which)return e.preventDefault(),!1}))}}).init()}));